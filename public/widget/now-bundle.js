(()=>{var n={954:(n,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>a});var o=t(601),i=t.n(o),s=t(314),r=t.n(s)()(i());r.push([n.id,"/* src/styles/nowWidgetStyles.css */\n\n/* Global Styles */\n:root {\n  --button-color: #007bff;\n  --button-size: 60px;\n  --panel-width: 300px;\n  --theme-background: #ffffff;\n  --theme-color: #000000;\n}\n\n.dark-theme {\n  --theme-background: #333333;\n  --theme-color: #ffffff;\n}\n\n.hidden {\n  display: none;\n}\n\n/* Animations */\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Page Element Styles */\n/* #now-widget-host-content {\n  /* Styles for wrapping host content */\n\n/* Button Styles */\n#now-widget-container {\n  position: fixed;\n  top: 50%;\n  right: 20px; /* Adjust as needed (left or right) */\n  transform: translateY(-50%);\n  z-index: 10000; /* High z-index to overlay most elements */\n}\n\n.now-widget-button {\n  background-color: var(--button-color);\n  width: var(--button-size);\n  height: var(--button-size);\n  color: white;\n  border: none;\n  border-radius: 50%;\n  cursor: pointer;\n  font-size: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease;\n}\n\n.now-widget-button-content {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n\n.text-ring {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  animation: spin 60s linear infinite;\n}\n\n.now-text {\n  display: block;\n  pointer-events: none;\n}\n\n.fast-spin {\n  animation: spin 1s linear infinite;\n}\n\n.slow-spin {\n  animation: spin 5s linear infinite;\n}\n\n/* Panel Styles */\n#now-widget-panel {\n  position: fixed;\n  top: 0;\n  right: -30vw; /* Hidden by default */\n  width: 30vw;\n  height: 100%;\n  background-color: var(--theme-background);\n  color: var(--theme-color);\n  box-shadow: -2px 0 5px rgba(0, 0, 0, 0.3);\n  transition: right 0.3s ease;\n  z-index: 9999; /* Below the button */\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n}\n\n#now-widget-panel.open {\n  left: 0;\n}\n\n.now-widget-close-button {\n  align-self: flex-end;\n  background: none;\n  border: none;\n  font-size: 24px;\n  cursor: pointer;\n  margin: 10px;\n  color: var(--theme-color);\n}\n\n.now-widget-user-info {\n  display: flex;\n  align-items: center;\n  margin-bottom: 20px;\n  padding: 0 20px;\n}\n\n.now-widget-avatar {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  margin-right: 15px;\n}\n\n.now-widget-user-details {\n  flex: 1;\n}\n\n.now-widget-user-name {\n  margin: 0;\n  font-size: 1.2rem;\n}\n\n.now-widget-user-bio {\n  margin: 5px 0 0 0;\n  font-size: 0.9rem;\n  color: gray;\n}\n\n.now-widget-post {\n  border-bottom: 1px solid #ddd;\n  padding: 10px 20px;\n}\n\n.now-widget-post h3 {\n  margin: 0 0 5px 0;\n  font-size: 1rem;\n}\n\n.now-widget-post p {\n  margin: 0;\n  font-size: 0.9rem;\n}\n\n.now-widget-hidden {\n  display: none;\n}\n\n.now-widget-loading {\n  display: block;\n  text-align: center;\n  margin: 20px 0;\n  font-size: 1rem;\n  color: gray;\n}\n\n.now-widget-error {\n  display: block;\n  text-align: center;\n  margin: 20px 0;\n  font-size: 1rem;\n  color: red;\n}\n\n/* Hashtag Styling */\n.now-widget-hashtag a {\n  color: #1e90ff;\n  text-decoration: none;\n}\n\n.now-widget-hashtag a:hover {\n  text-decoration: underline;\n}\n\n/* Responsive Design */\n@media (max-width: 1200px) {\n  #now-widget-panel {\n    width: 50vw;\n    right: -50vw;\n  }\n\n  #now-widget-panel.open {\n    right: 0;\n  }\n}\n\n@media (max-width: 768px) {\n  #now-widget-panel {\n    width: 80vw;\n    right: -80vw;\n  }\n\n  #now-widget-panel.open {\n    right: 0;\n  }\n}\n\n@media (max-width: 600px) {\n  #now-widget-panel {\n    width: 100%;\n    right: -100%;\n  }\n\n  #now-widget-panel.open {\n    right: 0;\n  }\n\n  #now-widget-container {\n    right: 10px;\n    left: auto;\n  }\n}\n",""]);const a=r},314:n=>{"use strict";n.exports=function(n){var e=[];return e.toString=function(){return this.map((function(e){var t="",o=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),o&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),o&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t})).join("")},e.i=function(n,t,o,i,s){"string"==typeof n&&(n=[[null,n,void 0]]);var r={};if(o)for(var a=0;a<this.length;a++){var d=this[a][0];null!=d&&(r[d]=!0)}for(var l=0;l<n.length;l++){var c=[].concat(n[l]);o&&r[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),t&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=t):c[2]=t),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},601:n=>{"use strict";n.exports=function(n){return n[1]}},422:(n,e,t)=>{var o=t(954);o&&o.__esModule&&(o=o.default),n.exports="string"==typeof o?o:o.toString()}},e={};function t(o){var i=e[o];if(void 0!==i)return i.exports;var s=e[o]={id:o,exports:{}};return n[o](s,s.exports,t),s.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},(()=>{"use strict";var n=function(n,e,t,o){return new(t||(t=Promise))((function(i,s){function r(n){try{d(o.next(n))}catch(n){s(n)}}function a(n){try{d(o.throw(n))}catch(n){s(n)}}function d(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(r,a)}d((o=o.apply(n,e||[])).next())}))};const e="http://localhost:3000",o=(t,o)=>n(void 0,void 0,void 0,(function*(){try{const n=yield fetch(`${e}/api/widget/user-info?userId=${t}`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(401===n.status)throw new Error("Authentication failed. Please check your token.");if(!n.ok)throw new Error(`Failed to fetch user info: ${n.statusText}`);return(yield n.json()).user}catch(n){return console.error(n),null}})),i=(t,o)=>n(void 0,void 0,void 0,(function*(){try{const n=yield fetch(`${e}/api/widget/user-posts?userId=${t}`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(401===n.status)throw new Error("Authentication failed. Please check your token.");if(!n.ok)throw new Error(`Failed to fetch posts: ${n.statusText}`);return(yield n.json()).posts}catch(n){return console.error(n),[]}}));let s;const r={isPanelOpen:!1,isLoading:!1,error:null,posts:[],user:null},a=n=>{r.isLoading=n,d()},d=()=>{if(console.log("updating UI"),!s)return void console.error("Widget root is not initialized.");const n=s.getElementById("now-widget-panel");n&&(r.isLoading?l(n):c(n),r.error?u(n,r.error):(p(n),h(r.user,n),m(r.posts,n)))},l=n=>{let e=n.querySelector(".now-widget-loading");e||(e=document.createElement("div"),e.classList.add("now-widget-loading"),e.textContent="Loading...",n.appendChild(e)),e.style.display="block"},c=n=>{const e=n.querySelector(".now-widget-loading");e&&(e.style.display="none")},u=(n,e)=>{let t=n.querySelector(".now-widget-error");t||(t=document.createElement("div"),t.classList.add("now-widget-error"),n.appendChild(t)),t.textContent=`Error: ${e}`,t.style.display="block"},p=n=>{const e=n.querySelector(".now-widget-error");e&&(e.style.display="none")},g=()=>{const n=document.getElementsByTagName("script");let e=null;for(let t=0;t<n.length;t++){const o=n[t];if(o.getAttribute("data-user-id")&&o.getAttribute("data-token")){e=o;break}}if(!e)return console.error("NowWidget: Unable to locate the current script."),null;const t=e.getAttribute("data-user-id"),o=e.getAttribute("data-token"),i=e.getAttribute("data-theme"),s=e.getAttribute("data-position"),r=e.getAttribute("data-button-color"),a=e.getAttribute("data-button-size");return t&&o?{userId:t,token:o,theme:null!=i?i:void 0,position:null!=s?s:void 0,buttonColor:null!=r?r:void 0,buttonSize:null!=a?a:void 0}:(console.error("NowWidget: Missing userId or token in script attributes."),null)},w=(n,e)=>{const t=e.getElementById("now-widget-panel");if(t){n?t.classList.add("open"):t.classList.remove("open");const e=getComputedStyle(t).width,o=document.getElementById("now-widget-host-content");o&&(o.style.marginLeft=n?e:"0")}else console.error("Panel element not found")},h=(n,e)=>{const t=e.querySelector(".now-widget-user-info");t&&n&&(t.innerHTML=`\n            <img src="${n.image||"/placeholder-user.jpg"}" alt="${n.displayName||n.name}" class="now-widget-avatar">\n            <div class="now-widget-user-details">\n                <h2 class="now-widget-user-name">${n.displayName||n.name}</h2>\n                <p class="now-widget-user-bio">${n.bio||""}</p>\n            </div>\n        `)},m=(n,e)=>{const t=e.querySelector("#now-widget-content");t&&(t.innerHTML="<h2>Your Posts</h2>",n.forEach((n=>{const e=document.createElement("div");e.className="now-widget-post",e.innerHTML=`<p>${n.content}</p>`,t.appendChild(e)})))},f=(n,e)=>{e.innerHTML="<h2>Your Posts</h2>",n.forEach((n=>{const t=document.createElement("div");t.className="now-widget-post",t.innerHTML=`<p>${y(n.content)}</p>`,e.appendChild(t)}))},y=n=>n.split(" ").map((n=>n.startsWith("#")?`<span class="now-widget-hashtag"><a href="/hashtag/${n.slice(1)}">${n}</a></span>`:`${n} `)).join("");let v;const b=()=>{v=requestAnimationFrame(b)};var x=t(422),E=t.n(x);const L=n=>{return e=void 0,t=void 0,c=function*(){(()=>{const n=document.body,e=document.createElement("div");for(e.id="now-widget-host-content";n.firstChild;)e.appendChild(n.firstChild);n.appendChild(e)})(),(()=>{const n=document.createElement("style");n.textContent="\n        /* Host content container */\n        #now-widget-host-content {\n            transition: margin-left 0.3s ease;\n        }\n\n        /* When panel is open, push content to the right */\n        #now-widget-host-content.panel-open {\n            margin-left: 30vw;\n        }\n\n        /* Responsive adjustments */\n        @media (max-width: 1200px) {\n            #now-widget-host-content.panel-open {\n                margin-left: 50vw;\n            }\n        }\n\n        @media (max-width: 768px) {\n            #now-widget-host-content.panel-open {\n                margin-left: 80vw;\n            }\n        }\n    ",document.head.appendChild(n)})();const n=(()=>{const n=document.createElement("div"),e=n.attachShadow({mode:"open"});return document.body.appendChild(n),e})();s=n;const e=g();if(!e)return;const{userId:t,token:l,theme:c,position:u,buttonColor:p,buttonSize:h}=e;(()=>{let n=document.getElementById("now-widget-container");n||(n=document.createElement("div"),n.id="now-widget-container",document.body.appendChild(n))})(),b();const m=((n,e={})=>{const{color:t="#007bff",size:o=50,backgroundColor:i="transparent"}=e,s=document.createElement("button");s.id="now-widget-button",s.type="button",s.style.backgroundColor=i,s.style.border="none",s.style.cursor="pointer",s.style.width=`${o}px`,s.style.height=`${o}px`,s.style.borderRadius="50%";const r=document.createElement("div");r.classList.add("now-widget-button-content");const a=document.createElement("div");return a.classList.add("text-ring"),"NOW.NOW.NOW.NOW.NOW.NOW.".split("").forEach(((n,e)=>{const o=document.createElement("span");o.classList.add("now-text"),o.textContent=n,o.style.position="absolute",o.style.top="50%",o.style.left="50%",o.style.transform=`\n            translate(-50%, -50%)\n            rotate(${15*e}deg)\n            translateY(-4ch)\n        `,o.style.fontSize="1.1rem",o.style.fontWeight="bold",o.style.background=`linear-gradient(45deg, ${t}, #FF4500)`,o.style.webkitBackgroundClip="text",o.style.webkitTextFillColor="transparent",o.style.backgroundClip="text",o.style.color="transparent",a.appendChild(o)})),r.appendChild(a),s.appendChild(r),s.addEventListener("mouseenter",(()=>{a.classList.add("fast-spin"),a.classList.remove("slow-spin")})),s.addEventListener("mouseleave",(()=>{a.classList.remove("fast-spin")})),s.addEventListener("click",(()=>{console.log("NowButton clicked"),n()})),s})((()=>w(!0,n)),{color:p,size:h?parseInt(h):void 0,backgroundColor:"transparent"});n.appendChild(m);const y=(n=>{const{userId:e,token:t,posts:o,user:i}=n,s=document.createElement("div");s.id="now-widget-panel",s.classList.add("now-widget-panel");const r=document.createElement("button");r.classList.add("now-widget-close-button"),r.innerHTML="&times;",r.onclick=()=>w(!1,s.getRootNode()),s.appendChild(r);const a=document.createElement("div");if(a.classList.add("now-widget-content"),console.log("Panel created with id and class:",s.id,s.className),s.appendChild(a),i){const n=document.createElement("div");n.className="now-widget-user-info",n.innerHTML=`\n      <img src="${i.image||"/placeholder-user.jpg"}" alt="${i.displayName||i.name}" class="now-widget-avatar">\n      <div class="now-widget-user-details">\n        <h2 class="now-widget-user-name">${i.displayName||i.name}</h2>\n        <p class="now-widget-user-bio">${i.bio||""}</p>\n      </div>\n    `,a.appendChild(n)}const d=document.createElement("div");return d.id="now-widget-content",a.appendChild(d),f(o,d),s})({userId:t,token:l,posts:[],user:null});n.appendChild(y),n.addEventListener("click",(e=>{const t=e.target;y.contains(t)||m.contains(t)||w(!1,n)}));const v=document.createElement("style");v.textContent=E(),n.appendChild(v),console.log("Styles appended to shadow root"),a(!0);try{const[n,e]=yield Promise.all([i(t,l),o(t,l)]);(n=>{r.posts=n,d()})(n),(n=>{r.user=n,d()})(e),((n,e)=>{const{userId:t,token:o,posts:i,user:s}=e;n.innerHTML="";const r=document.createElement("button");r.classList.add("now-widget-close-button"),r.innerHTML="&times;",r.onclick=()=>w(!1,n.getRootNode()),n.appendChild(r);const a=document.createElement("div");if(a.classList.add("now-widget-content"),n.appendChild(a),s){const n=document.createElement("div");n.className="now-widget-user-info",n.innerHTML=`\n      <img src="${s.image||"/placeholder-user.jpg"}" alt="${s.displayName||s.name}" class="now-widget-avatar">\n      <div class="now-widget-user-details">\n        <h2 class="now-widget-user-name">${s.displayName||s.name}</h2>\n        <p class="now-widget-user-bio">${s.bio||""}</p>\n      </div>\n    `,a.appendChild(n)}const d=document.createElement("div");d.id="now-widget-content",a.appendChild(d),f(i,d)})(y,{userId:t,token:l,posts:n,user:e})}catch(n){(n=>{(n=>{r.error=n,d()})(n)})(n.message)}finally{a(!1)}(n=>{const e=document.getElementsByClassName("now-widget-panel");if(e.length>0){const t=e[0];"dark"===n?t.classList.add("dark-theme"):t.classList.remove("dark-theme")}})(c),(n=>{const e=document.getElementsByClassName("now-widget-panel");if(e.length>0){const t=e[0];"left"===n?(t.style.right="auto",t.style.left="20px"):(t.style.left="auto",t.style.right="20px")}})(u),(n=>{const e=n.getElementById("now-widget-button");null==e||e.addEventListener("click",(()=>w(!0,n))),window.addEventListener("scroll",(()=>(n=>{const e=n.getElementById("now-widget-button");window.scrollY>300?null==e||e.classList.add("hidden"):null==e||e.classList.remove("hidden")})(n))),n.addEventListener("mousemove",(e=>((n,e)=>{const t=e.getElementById("now-widget-button");if(t){const e=t.getBoundingClientRect(),o=Math.hypot(n.clientX-(e.left+e.width/2),n.clientY-(e.top+e.height/2))<200,i=t.matches(":hover"),s=t.querySelector(".text-ring");s&&((n,e,t)=>{e?(t.classList.add("fast-spin"),t.classList.remove("slow-spin")):n?(t.classList.add("slow-spin"),t.classList.remove("fast-spin")):t.classList.remove("slow-spin","fast-spin")})(o,i,s)}})(e,n)))})(n)},new((l=void 0)||(l=Promise))((function(n,o){function i(n){try{r(c.next(n))}catch(n){o(n)}}function s(n){try{r(c.throw(n))}catch(n){o(n)}}function r(e){var t;e.done?n(e.value):(t=e.value,t instanceof l?t:new l((function(n){n(t)}))).then(i,s)}r((c=c.apply(e,t||[])).next())}));var e,t,l,c};document.addEventListener("DOMContentLoaded",(()=>{return n=void 0,e=void 0,o=function*(){console.log("init");const n=g();if(!n)return;const{userId:e,token:t,theme:o,position:i,buttonColor:s,buttonSize:r}=n;yield L(r&&parseInt(r))},new((t=void 0)||(t=Promise))((function(i,s){function r(n){try{d(o.next(n))}catch(n){s(n)}}function a(n){try{d(o.throw(n))}catch(n){s(n)}}function d(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(r,a)}d((o=o.apply(n,e||[])).next())}));var n,e,t,o}))})()})();